function addBoxes(e){for(i=1;i<=e;i++)$(pleaf(id)).addClass("box1").appendTo(".dynamicContent #content");persona_infyscroll_scene.update(),$("#loader").removeClass("active")}function persona(){persona_infyscroll_cntlr=new ScrollMagic.Controller,persona_infyscroll_scene=new ScrollMagic.Scene({triggerElement:".dynamicContent #loader",triggerHook:"onEnter"}).addTo(persona_infyscroll_cntlr).on("enter",function(e){$("#loader").hasClass("active")||($("#loader").addClass("active"),console&&console.log("loading new items"),setTimeout(addBoxes,2e3,9))}),addBoxes(2),$.ajax({url:"/api/v1/a/pings/graphs/wc/20170101/20180101",type:"GET",contentType:"application/json; charset=utf-8",dataType:"json",success:function(e,t){var a=e.data.wc.split(/[,\. ]+/g);e=Highcharts.reduce(a,function(e,t){var a=Highcharts.find(e,function(e){return e.name===t});return a?a.weight+=1:(a={name:t,weight:1},e.push(a)),e},[]);Highcharts.chart("wcchart",{series:[{type:"wordcloud",data:e,name:"Frequency"}],title:{text:"Ping Cloud"}})},async:!1}),Highcharts.chart("persona_area",{chart:{type:"area"},title:{text:"Near By Ping Activity"},xAxis:{allowDecimals:!1,labels:{formatter:function(){return this.value}}},yAxis:{title:{text:"# pings"},labels:{formatter:function(){return this.value/1e3+"k"}}},tooltip:{pointFormat:"{series.name} produced <b>{point.y:,.0f}</b><br/>neighborhood in {point.x}"},plotOptions:{area:{pointStart:2017,marker:{enabled:!1,symbol:"circle",radius:1,states:{hover:{enabled:!0}}}}},series:[{name:"Pings",data:[1e3,13500,14e3,1500,16e3,2e4,18e3,9e3,5e3,4500,11e3,14e3]}]}),Highcharts.chart("pchart",{chart:{plotBackgroundColor:null,plotBorderWidth:null,plotShadow:!1,type:"pie"},title:{text:"Ping Popularity January, 2017 to December, 2017"},tooltip:{pointFormat:"{series.name}: <b>{point.percentage:.1f}%</b>"},plotOptions:{pie:{allowPointSelect:!0,cursor:"pointer",dataLabels:{enabled:!0,format:"<b>{point.name}</b>: {point.percentage:.1f} %",style:{color:Highcharts.theme&&Highcharts.theme.contrastTextColor||"black"},connectorColor:"silver"}}},series:[{name:"Pings",data:[{name:"Thanks",y:25.95},{name:"Happy",y:25.13,sliced:!0,selected:!0},{name:"Love",y:24.61},{name:"Sad",y:24.57},{name:"Change",y:24.85}]}]}),Highcharts.chart("bchart",{title:{text:"Ping At a Glance"},xAxis:{categories:["Q1","Q2","Q3","Q4"]},series:[{type:"column",name:"Love",data:[3,2,1,3]},{type:"column",name:"Sad",data:[2,3,5,7]},{type:"column",name:"Change",data:[4,3,3,9]},{type:"column",name:"Thanks",data:[4,3,3,9]},{type:"column",name:"Happy",data:[4,3,3,9]},{type:"spline",name:"Average",data:[3,2.67,3,6.33],marker:{lineWidth:2,lineColor:Highcharts.getOptions().colors[3],fillColor:"white"}}]})}function stats(){Highcharts.chart("stats_area",{chart:{type:"area"},title:{text:"Near By Ping Activity"},xAxis:{allowDecimals:!1,labels:{formatter:function(){return this.value}}},yAxis:{title:{text:"# pings"},labels:{formatter:function(){return this.value/1e3+"k"}}},tooltip:{pointFormat:"{series.name} produced <b>{point.y:,.0f}</b><br/>neighborhood in {point.x}"},plotOptions:{area:{pointStart:2017,marker:{enabled:!1,symbol:"circle",radius:1,states:{hover:{enabled:!0}}}}},series:[{name:"Pings",data:[1e3,13500,14e3,1500,16e3,2e4,18e3,9e3,5e3,4500,11e3,14e3]}]}),Highcharts.chart("pchart",{chart:{plotBackgroundColor:null,plotBorderWidth:null,plotShadow:!1,type:"pie"},title:{text:"Ping Popularity January, 2017 to December, 2017"},tooltip:{pointFormat:"{series.name}: <b>{point.percentage:.1f}%</b>"},plotOptions:{pie:{allowPointSelect:!0,cursor:"pointer",dataLabels:{enabled:!0,format:"<b>{point.name}</b>: {point.percentage:.1f} %",style:{color:Highcharts.theme&&Highcharts.theme.contrastTextColor||"black"},connectorColor:"silver"}}},series:[{name:"Pings",data:[{name:"Thanks",y:25.95},{name:"Happy",y:25.13,sliced:!0,selected:!0},{name:"Love",y:24.61},{name:"Sad",y:24.57},{name:"Change",y:24.85}]}]}),Highcharts.chart("bchart",{title:{text:"Ping At a Glance"},xAxis:{categories:["Q1","Q2","Q3","Q4"]},series:[{type:"column",name:"Love",data:[3,2,1,3]},{type:"column",name:"Sad",data:[2,3,5,7]},{type:"column",name:"Change",data:[4,3,3,9]},{type:"column",name:"Thanks",data:[4,3,3,9]},{type:"column",name:"Happy",data:[4,3,3,9]},{type:"spline",name:"Average",data:[3,2.67,3,6.33],marker:{lineWidth:2,lineColor:Highcharts.getOptions().colors[3],fillColor:"white"}}]})}function shwmp(){interval=setInterval(chkLatLng,1e3),$(".sbtn").click(function(e){var t=map.getBounds(),a=t.getSouthWest().wrap(),n=t.getNorthEast().wrap(),o=[a.lat,a.lng,n.lat,n.lng];$(function(){$(".plusbtn").toggleClass("open"),$(".social-button").toggleClass("active")}),$.ajax({url:"/api/v1/ping/create",type:"POST",data:JSON.stringify({id:e.currentTarget.getAttribute("id"),d:duration,swlat:o[0],swlon:o[1],nelat:o[2],nelon:o[3]}),contentType:"application/json; charset=utf-8",dataType:"json",success:function(e,t){L.marker([e.lat,e.lng]).addTo(map).setIcon(new L.icon({iconUrl:"/static/images/bigicons/"+e.iurl+".png",iconSize:[60,60]})).bindPopup(epleaf(e.id,e.iurl)).openPopup()},async:!1})}),$(".plus-button").click(function(){$(".plusbtn").toggleClass("open"),$(".social-button").toggleClass("active")})}function epleaf(e,t){alert("hiii");var a={pingTitle:t.charAt(0).toUpperCase()+t.slice(1).toLowerCase(),pingIcon:"/static/images/bigicons/"+t+".png"};return Mustache.render("{{=[[ ]]=}}"+$("#epleaf-tmpl").html(),a)}function pleaf(e){var t={pingTitle:"",pingIcon:"",pingDesc:"",pingTime:"",pingLocation:""};$.ajax({url:"/api/v1/ping/"+e,type:"GET",contentType:"application/json; charset=utf-8",dataType:"json",success:function(e,a){t.pingLocation=e.city+", "+e.state+", "+e.country,t.pingTitle=e.pc,t.pingDesc=e.pd,t.pingTime=e.timezone,console.log(e)},async:!1});var a=$("#pleaf-tmpl").html();return Mustache.render("{{=[[ ]]=}}"+a,t)}function duration_handler(e){if(valid_durations.indexOf(e)>=0){switch(e){case"hr":duration="thish";break;case"dy":duration="thisd";break;case"wk":duration="thisw";break;case"mn":duration="thism";break;case"yr":duration="thisy";break;case"at":duration="alltime"}loadLayer()}}function showError(e){xhttp.onreadystatechange=function(){if(4==this.readyState&&200==this.status){var e=JSON.parse(this.responseText);lat=e.data.lat,lng=e.data.lng}},xhttp.open("GET","/api/v1/user/geoinfo?t="+Math.random(),!0),xhttp.send()}function chkLatLng(){void 0!=lat&&void 0!=lng&&(clearInterval(interval),initMap())}function loadLayer(){var e=map.getBounds(),t=e.getSouthWest().wrap(),a=e.getNorthEast().wrap(),n=[t.lat,t.lng,a.lat,a.lng];url="/api/v1/pings/map/"+duration+"/"+n[0]+"/"+n[1]+"/"+n[2]+"/"+n[3],map.eachLayer(function(e){default_mbox_layers.indexOf(e._leaflet_id)<0&&map.removeLayer(e)});L.mapbox.featureLayer().loadURL(url).on("ready",function(e){try{document.getElementById("ftr").innerHTML="Total Pings Loaded: "+Object.keys(e.target._layers).length;var t=new L.MarkerClusterGroup({showCoverageOnHover:!1,animateAddingMarkers:!0});t.on("click",function(e){console.log("marker"+e.layer.feature.properties.id)}),t.on("clusterclick",function(e){console.log("marker"+e.layer.getAllChildMarkers().length)}),e.target.eachLayer(function(e){e.setIcon(new L.icon({iconUrl:e.feature.properties.iconUrl})),e.on("click",function(t){e.bindPopup(pleaf(e.feature.properties.id))}),t.addLayer(e)}),map.addLayer(t)}catch(e){console.log("Got invalid geojson object")}})}function initMap(){L.mapbox.accessToken="pk.eyJ1IjoiYmFydHBpbmciLCJhIjoiY2pheTQ4Nm85MTQzejJxcWs4dWc5Yzh3cyJ9.0UyqGF5cYVmWnWmVodADYQ",(map=L.mapbox.map("map","mapbox.dark",{minZoom:4,zoomControl:!1,worldCopyJump:!0,attributionControl:!1,dragRotate:!1}).setView([lat,lng],8)).eachLayer(function(e){default_mbox_layers.push(e._leaflet_id)}),loadLayer(),map.on("zoomend",function(e){loadLayer()}),map.on("moveend",function(e){loadLayer()})}function clickfunction(){alert("I am an alert box!")}var lat,lng,map,persona_infyscroll_cntlr,persona_infyscroll_scene,url="",fls=[],interval=0,xhttp=new XMLHttpRequest,duration="thisd",valid_durations=["hr","dy","wk","mn","yr","at"],default_mbox_layers=[];navigator.geolocation?navigator.geolocation.getCurrentPosition(function(e){lat=e.coords.latitude,lng=e.coords.longitude},showError):(console.log("Geolocation is not supported by this browser."),showError("er")),$("#circle-show").hover(function(){$("#circle-hide").toggle()}),Highcharts.setOptions({colors:Highcharts.map(Highcharts.getOptions().colors,function(e){return{radialGradient:{cx:.5,cy:.3,r:.7},stops:[[0,e],[1,Highcharts.Color(e).brighten(-.3).get("rgb")]]}})}),$(function(){$("#clickclose").click(function(){alert("The paragraph was clicked.")})});
